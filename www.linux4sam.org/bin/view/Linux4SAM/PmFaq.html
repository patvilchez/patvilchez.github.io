<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">

<!-- Mirrored from www.linux4sam.org/bin/view/Linux4SAM/PmFaq by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Jul 2021 19:30:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=iso-8859-1" /><!-- /Added by HTTrack -->
<head>
<link rel="stylesheet" href="https://www.linux4sam.org/pub/TWiki/RedDotPlugin/style.css" type="text/css" media="all" />
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/JQueryPlugin/jquery.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/JQueryPlugin/jquery-migrate.js"></script>
<link rel="stylesheet" href="https://www.linux4sam.org/pub/TWiki/JQueryPlugin/jquery-all.css" type="text/css" media="all" />
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/JQueryPlugin/jquery-all.js"></script>
<title> PmFaq &lt; Linux4SAM &lt; TWiki</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="https://www.linux4sam.org/pub/Linux4SAM/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="https://www.linux4sam.org/pub/Linux4SAM/WebPreferences/favicon.ico" type="image/x-icon" />
<link rel="alternate" href="https://www.linux4sam.org/bin/edit/Linux4SAM/PmFaq?t=1625511572" type="application/x-wiki" title="Edit PmFaq" />
<link rel="edit" href="https://www.linux4sam.org/bin/edit/Linux4SAM/PmFaq?t=1625511572" title="Edit PmFaq" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="WebRss" />
<base ></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('https://www.linux4sam.org/pub/TWiki/TWikiTemplates/base.css');
</style>
<style type="text/css" media="all">

#patternTopBar,
#patternClearHeaderCenter,
#patternClearHeaderLeft,
#patternClearHeaderRight,
#patternTopBarContentsOuter,
#patternTopBarContents {
	height:100px; /* top bar height; make room for header columns */
	overflow:hidden;
}


#patternOuter {
	margin-left:14em;
}
#patternLeftBar {
	width:14em;
	margin-left:-14em;
}
</style>
<style type="text/css" media="all">
@import url('https://www.linux4sam.org/pub/TWiki/PatternSkin/layout.css');
@import url('https://www.linux4sam.org/pub/TWiki/PatternSkin/style.css');
@import url('https://www.linux4sam.org/pub/TWiki/PatternSkin/colors.css');
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	.patternBookView .twikiTopRow,
	.patternWebIndicator a img,
	.patternWebIndicator a:hover img {
		background-color:#D0D0D0;
	}
	#patternTopBarContents { background-image:url(https://www.linux4sam.org/pub/TWiki/PatternSkin/TWiki_header.gif); background-repeat:no-repeat;}
	
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/pub/TWiki/PreviewBackground/preview2bg.gif");*/
	}
	
</style><style type="text/css" media="all">


@import url('https://www.linux4sam.org/pub/TWiki/Linux4SAM/mystyle.css');
</style>
<style type="text/css" media="all">
	@import url("https://www.linux4sam.org/pub/TWiki/PatternSkin/print.css");
</style>
<!--[if IE]><style type="text/css" media="screen">
pre {
	overflow-x:auto;
	padding-bottom:expression(this.scrollWidth > this.offsetWidth ? 16 : 0);
}
</style>
<![endif]-->
<!--[if lte IE 6]> 
<style type="text/css">
#patternLeftBar {
	position:relative; /* IE 5.5 needs this or the contents won't show outside the parent container on print. IE 6.0 needs it only during printable copy! */
}
</style><![endif]-->
<script type="text/javascript" src="https://www.linux4sam.org/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script>
</head>
<body class="patternViewPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternWrapper"><div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternClearHeaderCenter">
</div>
<p />
<div id="patternMainContents"><div class="patternTop"><span class="patternHomePath twikiLeft">
<a class="twikiCurrentWebHomeLink twikiLink" href="WebHome.html">Linux4SAM</a><span class='natSep'>&nbsp;&#187; </span><a class="twikiLink" href="WebFaqBaseForm.html">WebFaqBaseForm</a><span class='natSep'>&nbsp;&#187; </span><a class="twikiLink" href="WebFaq.html">WebFaq</a><span class='natSep'>&nbsp;&#187; </span><a class="twikiCurrentTopicLink twikiLink" href="PmFaq.html">PmFaq</a>
</span><!-- /patternHomePath--><span class="patternToolBar twikiRight"></span><!-- /patternToolBar--><br class="twikiClear" /></div><!--/patternTop--><div class="twikiContentHeader"></div><div class="patternContent"><div class="patternTopic"> <h1><a name="How_to_use_SAMA5D2_power_managem"></a>  How to use <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes </h1>
<p />
<div class="twikiToc"> <ul>
<li> <a href="#Introduction"> Introduction</a>
</li> <li> <a href="#Available_modes"> Available modes</a>
</li> <li> <a href="#Supported_boards"> Supported boards</a>
</li> <li> <a href="#AT91Bootstrap_support"> AT91Bootstrap support</a>
</li> <li> <a href="#Linux_kernel_paramenters"> Linux kernel paramenters</a>
</li> <li> <a href="#Examples_of_configurations"> Examples of configurations</a> <ul>
<li> <a href="#How_to_use_ULP0_and_Backup_and_s"> How to use ULP0 and Backup and self-refresh SAMA5D2 power management modes </a>
</li> <li> <a href="#How_to_use_ULP0_and_ULP1_SAMA5D2"> How to use ULP0 and ULP1 SAMA5D2 power management modes</a>
</li> <li> <a href="#How_to_use_standard_Linux_power"> How to use standard Linux power management modes</a>
</li></ul> 
</li> <li> <a href="#Wake_up_sources_for_SAMA5D2_Xpla"> Wake up sources for SAMA5D2 Xplained board</a> <ul>
<li> <a href="#Wake_up_sources_for_ULP0_and_sta"> Wake up sources for ULP0 and standard Linux standby mode</a> <ul>
<li> <a href="#sys_devices_power_wakeup"> /sys/devices/.../power/wakeup</a>
</li> <li> <a href="#Device_tree_wakep"> Device tree wakep</a>
</li></ul> 
</li> <li> <a href="#Wake_up_sources_for_ULP1_mode"> Wake up sources for ULP1 mode</a> <ul>
<li> <a href="#Linux4sam_6_0_kernel"> Linux4sam 6.0 kernel</a>
</li> <li> <a href="#Vanilla_kernel"> Vanilla kernel</a>
</li></ul> 
</li> <li> <a href="#Wake_up_sources_for_backup_and_s"> Wake up sources for backup and self-refresh mode</a>
</li></ul> 
</li> <li> <a href="#Limitations"> Limitations</a>
</li></ul> 
</div>
<p />
<h2><a name="Introduction"></a> Introduction </h2>
<p />
This page describes the way <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes could be used in Linux.
<p />
<h2><a name="Available_modes"></a> Available modes </h2>
<p />
The <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes are
<pre>
Idle - CPU switch to WFI
ULP0 - clocks are switch to low frequencies and CPU wakes on any interrupt
ULP1 - clocks are off and the number of CPU wake up sources is limited
Backup and Self-refresh - CPU is shutdown and DDR memory is switch to self-refresh mode 
</pre>
<p />
<h2><a name="Supported_boards"></a> Supported boards </h2>
<p />
The ULP0, ULP1 and backup and self-refresh <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes are currently supported only by <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board.
<p />
<h2><a name="AT91Bootstrap_support"></a> <a class="twikiLink" href="AT91Bootstrap.html">AT91Bootstrap</a> support </h2>
<p />
To be able to use <code>backup and self-refresh</code> mode the <a class="twikiLink" href="AT91Bootstrap.html">AT91Bootstrap</a> has to be compiled with the following compilation flag:
<p />
<pre>CONFIG&#95;BACKUP&#95;MODE</pre>
<p />
The other power management modes could be used without special support in <a class="twikiLink" href="AT91Bootstrap.html">AT91Bootstrap</a>.
<p />
<h2><a name="Linux_kernel_paramenters"></a> Linux kernel paramenters </h2>
<p />
When switching to a low power mode Linux will use a <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes if these modes were previously specified as kernel parameter from bootloader.
<p />
In Linux4sam reference distributions U-Boot is used as kernel bootloader. The <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes are passed to kernel via <code>bootargs</code> U-Boot variable in the format:
<p />
<pre>atmel.pm&#95;modes&#61;&#60;standby-mode&#62;,&#60;suspend-mode&#62;</pre>
<p />
The following table describes the value that could be provided in <code>atmel.pm_modes</code> variable and it's effect when executing Linux specific power management commands. 
<p />
<table border="1" cellpadding="0" cellspacing="0" class="twikiTable" id="table1" rules="all">
<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
<td bgcolor="#ffffff" class="twikiTableCol0 twikiFirstCol" valign="top"> <b>Mode</b> </td>
<td bgcolor="#ffffff" class="twikiTableCol1" valign="top"> <b>Value</b> </td>
<td bgcolor="#ffffff" class="twikiTableCol2" valign="top"> <b>Selected by Linux command</b> </td>
<td bgcolor="#ffffff" class="twikiTableCol3 twikiLastCol" valign="top"> <b>Action while executing Linux power saving commands </td>
</tr>
<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
<td bgcolor="#edf4f9" class="twikiTableCol0 twikiFirstCol" rowspan="4" valign="top"> standby-mode </td>
<td bgcolor="#edf4f9" class="twikiTableCol1" valign="top"> standby </td>
<td bgcolor="#edf4f9" class="twikiTableCol2" rowspan="4" valign="top"> echo standby &gt; /sys/power/state </td>
<td bgcolor="#edf4f9" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to normal Linux standby mode </td>
</tr>
<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
<td bgcolor="#ffffff" class="twikiTableCol1" valign="top"> ulp0 </td>
<td bgcolor="#ffffff" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> ULP0 mode </td>
</tr>
<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
<td bgcolor="#edf4f9" class="twikiTableCol1" valign="top"> ulp1 </td>
<td bgcolor="#edf4f9" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> ULP1 mode </td>
</tr>
<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
<td bgcolor="#ffffff" class="twikiTableCol1" valign="top"> backup </td>
<td bgcolor="#ffffff" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> backup and self-refresh mode </td>
</tr>
<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
<td bgcolor="#edf4f9" class="twikiTableCol0 twikiFirstCol twikiLast" rowspan="4" valign="top"> suspend-mode </td>
<td bgcolor="#edf4f9" class="twikiTableCol1" valign="top"> standby </td>
<td bgcolor="#edf4f9" class="twikiTableCol2 twikiLast" rowspan="4" valign="top"> echo mem &gt; /sys/power/state </td>
<td bgcolor="#edf4f9" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to normal Linux standby mode </td>
</tr>
<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
<td bgcolor="#ffffff" class="twikiTableCol1" valign="top"> ulp0 </td>
<td bgcolor="#ffffff" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> ULP0 mode </td>
</tr>
<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
<td bgcolor="#edf4f9" class="twikiTableCol1" valign="top"> ulp1 </td>
<td bgcolor="#edf4f9" class="twikiTableCol3 twikiLastCol" valign="top"> Switching to <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> ULP1 mode </td>
</tr>
<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
<td bgcolor="#ffffff" class="twikiTableCol1 twikiLast" valign="top"> backup </td>
<td bgcolor="#ffffff" class="twikiTableCol3 twikiLastCol twikiLast" valign="top"> Switching to <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> backup and self-refresh mode </td>
</tr></table>
<p />
<h2><a name="Examples_of_configurations"></a> Examples of configurations </h2>
<p />
The following examples assume that user used <a class="twikiLink" href="AT91Bootstrap.html">AT91Bootstrap</a> and U-Boot bootloaders.
<p />
<h3><a name="How_to_use_ULP0_and_Backup_and_s"></a> How to use ULP0 and Backup and self-refresh <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes </h3>
<p />
To be able to use ULP0 and backup and self-refresh <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes the following settings has to be done:
<p />
<pre>
1. Compile AT91Bootstrap with CONFIG&#95;BACKUP&#95;MODE flag
2. U-Boot bootargs variable has to contain: atmel.pm&#95;modes&#61;ulp0,backup
</pre>
<p />
For instance, on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board which boots form SD card, U-Boot <code>bootargs</code> should look similar to this:
<p />
<pre>
bootargs&#61;console&#61;ttyS0,115200 root&#61;/dev/mmcblk0p2 rw rootfstype&#61;ext4 rootwait atmel.pm&#95;modes&#61;ulp0,backup
</pre>
<p />
To switch to <code>ULP0</code> mode from Linux execute the following command:
<p />
<pre>echo standby &#62; /sys/power/state</pre>
<p />
To switch to <code>backup and self-refresh</code> mode from Linux execute the following command:  
<p />
<pre>echo mem &#62; /sys/power/state</pre>
<p />
<h3><a name="How_to_use_ULP0_and_ULP1_SAMA5D2"></a> How to use ULP0 and ULP1 <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes </h3>
<p />
To be able to use ULP0 and ULP1 <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes the following settings has to be done:
<p />
<pre>
1. U-Boot bootargs variable has to contain: atmel.pm&#95;modes&#61;ulp0,ulp1
</pre>
<p />
For instance, on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board which boots form SD card, U-Boot <code>bootargs</code> should look similar to this:
<p />
<pre>
bootargs&#61;console&#61;ttyS0,115200 root&#61;/dev/mmcblk0p2 rw rootfstype&#61;ext4 rootwait atmel.pm&#95;modes&#61;ulp0,ulp1
</pre>
<p />
To switch to <code>ULP0</code> mode from Linux execute the following command:
<p />
<pre>echo standby &#62; /sys/power/state</pre>
<p />
To switch to <code>ULP1</code> mode from Linux execute the following command:  
<p />
<pre>echo mem &#62; /sys/power/state</pre>
<p />
If, instead of using <code>echo standby &gt; /sys/power/state</code> to switch to ULP0 you want to use <code>echo mem &gt; /sys/power/state</code> and vice versa, the <code>atmel.pm_modes</code> variable has to be in the format:
<p />
<pre>
atmel.pm&#95;modes&#61;ulp1,ulp0
</pre>
<p />
For instance, on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board which boots form SD card, U-Boot <code>bootargs</code> should look similar to this:
<p />
<pre>
bootargs&#61;console&#61;ttyS0,115200 root&#61;/dev/mmcblk0p2 rw rootfstype&#61;ext4 rootwait atmel.pm&#95;modes&#61;ulp1,ulp0
</pre>
<p />
<h3><a name="How_to_use_standard_Linux_power"></a> How to use standard Linux power management modes </h3>
<p />
To be able to use standard Linux power management modes just don't place <code>atmel.pm_modes</code> as part of U-Boot <code>bootargs</code> variable.
<p />
For instance, on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board which boots form SD card, U-Boot <code>bootargs</code> should look similar to this:
<p />
<pre>bootargs&#61;console&#61;ttyS0,115200 root&#61;/dev/mmcblk0p2 rw rootfstype&#61;ext4 rootwait</pre>
<p />
<h2><a name="Wake_up_sources_for_SAMA5D2_Xpla"></a> Wake up sources for <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board </h2>
<p />
This section will explain the wake up sources for <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board.
<p />
<h3><a name="Wake_up_sources_for_ULP0_and_sta"></a> Wake up sources for ULP0 and standard Linux standby mode </h3>
<p />
ULP0 and normal Linux standby mode could use any interrupt to wake up from a power management mode. There are 2 ways of configuring wake up sources:<br>
<b>1. via /sys/devices/.../power/wakeup</b><br>
<b>2. via device tree</b><br>
<p />
<h4><a name="sys_devices_power_wakeup"></a> /sys/devices/.../power/wakeup </h4>
<p />
To configure a device to act as a wake up source for ULP0 and standard Linux standby mode just type <code>enabled</code> or <code>disabled</code> in power/wakup file specific to the device.
<p />
For instance, to configure PB1 button on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board, to act as wake up source for ULP0 enter the following command on Linux:
<p />
<pre>
echo enabled &#62; /sys/devices/platform/gpio&#95;keys/power/wakeup
</pre>
<p />
Or, to disable it:
<p />
<pre>
echo disabled &#62; /sys/devices/platform/gpio&#95;keys/power/wakeup
</pre>
<p />
<h4><a name="Device_tree_wakep"></a> Device tree wakep </h4>
<p />
To configure a device to act as a wake up source for ULP0 and standard Linux standby mode just use "wakup-source" device tree propriety on the device itself in device tree.
<p />
For instance, to configure PB1 button on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board, to act as wake up source for ULP0 the device tree bindings for PB2 button should look similar to this:
<p />
<pre>
gpio&#95;keys {                                                             
   compatible &#61; &#34;gpio-keys&#34;;

   pinctrl-names &#61; &#34;default&#34;;
   pinctrl-0 &#61; &#60;&#38;pinctrl&#95;key&#95;gpio&#95;default&#62;;

   bp1 {
      label &#61; &#34;PB&#95;USER&#34;;
      gpios &#61; &#60;&#38;pioA PIN&#95;PB9 GPIO&#95;ACTIVE&#95;LOW&#62;;
      linux,code &#61; &#60;0x104&#62;;
      wakeup-source;
   };
};
</pre>
<p />
<h3><a name="Wake_up_sources_for_ULP1_mode"></a> Wake up sources for ULP1 mode </h3>
<p />
In ULP1 wake up source are limited.
<p />
<h4><a name="Linux4sam_6_0_kernel"></a> Linux4sam 6.0 kernel </h4>
<p />
In Linux4sam 6.0 wake up source for ULP1 could be configured via device tree.
<p />
For instance, to configure PB2 button and Ethernet to act as a wake up sources the device tree bindings for PMC should look similar to this:
<p />
<pre>
pmc: pmc&#64;f0014000 {
   pmc&#95;fast&#95;restart {
      compatible &#61; &#34;atmel,sama5d2-pmc-fast-startup&#34;;
      #address-cells &#61; &#60;1&#62;;
      #size-cells &#61; &#60;0&#62;;

      wkpin: input&#64;0 {
         reg &#61; &#60;0&#62;;
      };

      gmac&#95;wol: input&#64;10 {
         reg &#61; &#60;10&#62;;
         atmel,wakeup-active-high;
      };
   };
};
</pre>
<p />
For more information check <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/DS60001476B.pdf#G22.2193277" target="_blank">Fast startup for Ultra Low-Power (ULP) Mode 1<img alt="" border="0" height="12" src="https://www.linux4sam.org/pub/TWiki/TWikiDocGraphics/external-link.gif" width="13" /></a> in <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> datasheet
<p />
<h4><a name="Vanilla_kernel"></a> Vanilla kernel </h4>
<p />
In vanilla kernel ULP1 wake up sources could be configured via /sys/devices/.../power/wakeup files as explained above.
<p />
<h3><a name="Wake_up_sources_for_backup_and_s"></a> Wake up sources for backup and self-refresh mode </h3>
<p />
In backup and self refresh-mode wake up sources for <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained boards are limited to PB2 button.
<p />
For instance, to configure PB2 button on <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> Xplained board to act as wake up source the device tree bindings for shutdown controller should look similar to this:
<p />
<pre>
shdwc&#64;f8048010 {
   atmel,shdwc-debouncer &#61; &#60;976&#62;;
   
   input&#64;0 {
      reg &#61; &#60;0&#62;;
      atmel,wakeup-type &#61; &#34;low&#34;;
   };
};
</pre>
<p />
<h2><a name="Limitations"></a> Limitations </h2>
<p />
Linux4sam reference distributions supports all the <span class="twikiNewLink"><a href="https://www.linux4sam.org/bin/edit/Linux4SAM/SAMA5D2?topicparent=Linux4SAM.PmFaq;nowysiwyg=1" rel="nofollow" title="SAMA5D2 (this topic does not yet exist; you can create it)">SAMA5D2</a></span> power management modes described above. However to be able to use backup and self-refresh mode on vanilla kernel the following patch has to be applied on top of vanilla kernel for PMIC to correctly suspend and resume (these were currently accepted for Linux 4.21 and the device tree bindings will be included after 2 more Linux versions)
<p />
<a href="https://lore.kernel.org/lkml/1544543768-2066-6-git-send-email-claudiu.beznea@microchip.com/" target="_blank">ARM: dts: at91: sama5d2_xplained: Add proper regulator states for suspend-to-mem<img alt="" border="0" height="12" src="https://www.linux4sam.org/pub/TWiki/TWikiDocGraphics/external-link.gif" width="13" /></a><br>
<p />
For ULP1 implementation in vanilla kernel, currently, there is no way to resume from <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/DS60001476B.pdf#G21.1075409" target="_blank">ACC<img alt="" border="0" height="12" src="https://www.linux4sam.org/pub/TWiki/TWikiDocGraphics/external-link.gif" width="13" /></a> or <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/DS60001476B.pdf#G20.1086840" target="_blank">RXLP<img alt="" border="0" height="12" src="https://www.linux4sam.org/pub/TWiki/TWikiDocGraphics/external-link.gif" width="13" /></a> events. For this reason the in Linux4sam 6.0 the current implementation is still based on device tree bindings.
<p />
<p />
-- <style> .userReportsSig { display: inline-block; white-space: nowrap; padding: 0 2px 0 0; border: 1px solid #e8e8eb; background-color: #f4f4fa; -moz-box-shadow: 1px 1px 2px #e8e8e8; -webkit-box-shadow: 1px 1px 2px #e8e8e8; box-shadow: 1px 1px 2px #e8e8e8; -moz-border-radius: 4px; border-radius: 4px; } .userReportsSig a:link { border: 0 none; } .userReportsSig img { vertical-align: middle; } .userReportsBubble { position: absolute; background-image: url(../../../pub/TWiki/UserReports/faded-bubble.png); background-repeat: no-repeat; margin-top: -57px; margin-left: -18px; width: 920px; height: 90px; z-index: -1; } </style><span class="userReportsSig"> <a class="twikiLink" href="https://www.linux4sam.org/bin/login/Main/ClaudiuBeznea?origurl=/bin/view/Main/ClaudiuBeznea"><img src="../../../pub/Main/UserProfileHeader/default-user-profile.jpg" height="24" alt="" /> Claudiu Beznea  - 2018-10-17</a> </span> </div><!-- /patternTopic-->
<div class="twikiContentFooter"></div></div><!-- /patternContent-->
<div class="patternInfo twikiGrayText"><div class="patternRevInfo">r4 - 14 Dec 2018 - 11:18:34 - <a class="twikiLink" href="https://www.linux4sam.org/bin/login/Main/ClaudiuBeznea?origurl=/bin/view/Main/ClaudiuBeznea">ClaudiuBeznea</a></div><!-- /patternRevInfo--></div><!-- /patternInfo-->
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
<div id="patternLeftBar">
<div id="patternClearHeaderLeft"></div>
<div id="patternLeftBarContents">
<div class="patternWebIndicator"> <ul>
<li> <a class="twikiCurrentWebHomeLink twikiLink" href="WebHome.html"><img src="https://www.linux4sam.org/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" width="13" height="13" alt="Web background" title="Web background" border="0" /> Linux4SAM</a>
</li></ul> 
</div>
<br>
<h2><a name="Linux4SAM"></a> <a class="twikiCurrentWebHomeLink twikiLink" href="WebHome.html"> Linux4SAM</a> </h2>
<ul>
  <li><a class="twikiLink" href="SoftwareTools.html">Software tools</a></li>
  <li><a class="twikiLink" href="AT91Bootstrap.html">AT91Bootstrap</a></li>
  <li><a class="twikiLink" href="U-Boot.html">U-Boot</a>
  <li><a class="twikiLink" href="LinuxKernel.html">Linux Kernel</a></li>
  <li><a class="twikiLink" href="DT-Overlay.html">DT-Overlay</a></li>
</ul>
<p />
<u><a class="twikiCurrentWebHomeLink twikiAnchorLink" href="WebHome.html#Open_source_embedded_distributio">Open source solutions</a></u>
<ul>
    <li><a class="twikiLink" href="YoctoProject.html">Yocto Project</a></li>
    <!--<li><a class="twikiLink" href="/bin/view/Linux4SAM/OpenEmbeddedAngstrom">OpenEmbedded / Angstrom</a></li>-->
    <li><a class="twikiLink" href="BuildRoot.html">Buildroot</a></li>
    <li><a class="twikiLink" href="OpenWrt.html">OpenWrt</a></li>
</ul>
<p />
<u><a class="twikiCurrentWebHomeLink twikiAnchorLink" href="WebHome.html#Applications">Applications</a></u>
<ul>
    <li><a class="twikiAnchorLink" href="Applications.html#Graphics_Toolkit">Graphics Toolkit</a></li>
    <li><a class="twikiAnchorLink" href="Applications.html#WiFi_and_Bluetooth">WiFi and Bluetooth</a></li>
</ul>
<p />
<h2><a name="Boards"></a> Boards </h2>
<ul>
    <li><a class="twikiLink" href="Sama5d2IcpMainPage.html">SAMA5D2-ICP</a></li>
    <li><a class="twikiLink" href="Sama5d27WLSom1EKMainPage.html">SAMA5D27 WLSOM1 EK</a></li>
    <li><a class="twikiLink" href="Sam9x60EKMainPage.html">SAM9X60-EK</a></li>
    <li><a class="twikiLink" href="Sama5d27Som1EKMainPage.html">SAMA5D27 SOM1 EK</a></li>
    <li><a class="twikiLink" href="Sama5d2PtcEKMainPage.html">SAMA5D2 PTC EK</a></li>
    <li><a class="twikiLink" href="Sama5d2XplainedMainPage.html">SAMA5D2 Xplained</a></li>
    <li><a class="twikiLink" href="Sama5d3XplainedMainPage.html">SAMA5D3 Xplained</a></li>
    <li><a class="twikiLink" href="Sama5d4XplainedMainPage.html">SAMA5D4 Xplained</a></li>
    <li><a class="twikiLink" href="GettingStarted.html">Older boards</a></li>
</ul>
<p />
<p />
<h2><a name="FAQ"></a> <a class="twikiLink" href="WebFaq.html">FAQ</a> </h2>
<div class="twikiToc"> <ul>
<li> <a href="WebFaq.html#FAQ_updates_by_Boards"> FAQ updates by Boards</a>
</li> <li> <a href="WebFaq.html#FAQ_updates_by_Components"> FAQ updates by Components</a>
</li></ul> 
</div>
<p />
<!--
<u>FAQ</u>
<ul>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/U-BootFAQ">U-Boot FAQ</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/BuildRootFAQ">BuildRoot FAQ</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/AudioFAQ">Audio FAQ</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/FAQ_9x5">AT91SAM9x5 FAQ</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/FAQ_9n12">AT91SAM9N12 FAQ</a></li>
</ul>
<p />
<u><a class="twikiLink" href="/bin/view/Linux4SAM/TipsNTricks">Tips &amp; Tricks</a></u>
<ul>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/AudioRecordOnAt91sam9g20ek">9G20EK Audio Recording</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/SAM9M10Gstreamer">9M10 vdec with Gstreamer</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/IioAdcDriver">IIO ADC driver</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/RealTime">Real Time on A91SAM SoC</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/SDCardBootNotice">SD card boot for AT91SAM SoC</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/PmeccConfigure">NAND ECC configuration (PMECC)</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/AT91BootstrapDebugEclipse">AT91Bootstrap Debugging with Eclipse for Linux</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/UsingIsi">Using ISI (Image Sensor Interface)</a></li>
    <li><a class="twikiLink" href="/bin/view/Linux4SAM/UsingMaxTouch">Using maXTouch (capacitive touchscreen)</a></li>
</ul>
<p />
<br><br>
<h2><a name="Demos"></a> <a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demo_archives">Demos</a> </h2>
<p />
<u>For following products:</u>
<br><br>
<ul>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demoa5d4xplained">SAMA5D4 Xplained</a></li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demoa5d4ek">SAMA5D4-EK</a> <br />  &nbsp;</li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demoa5d3x">SAMA5D3x-EK</a></li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demoa5d3x_yocto">SAMA5D3x-EK <br /> Home Automation Demo <br />  with Yocto</a></li>
  <li><a href="http://www.timesys.com/embedded-linux/resources/dev-center/sama5d3" target="_blank">SAMA5D3x-EK <br /> Home Automation Demo <br />  with LinuxLink<img alt="" border="0" height="12" src="/pub/TWiki/TWikiDocGraphics/external-link.gif" width="13" /></a> <br />  &nbsp;</li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted_9n12#Demo_archives">AT91SAM9N12-EK</a></li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted_9x5#Demo_archives">AT91SAM9x5-EK</a></li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demo9m10g45ek">AT91SAM9M10G45-EK</a></li>
  <li><a class="twikiAnchorLink" href="/bin/view/Linux4SAM/GettingStarted#Demo9g20">AT91SAM9G20-EK</a></li>
</ul>
-->
<p />
<p />
<h2><a name="Useful_links"></a> <a class="twikiLink" href="LinksToCommunities.html">Useful links</a> </h2>
<ul>
  <li><a href="https://www.microchip.com/forums/f540.aspx" target="_blank">Microchip Microprocessors forums</a></li>
  <li><a href="http://www.at91.com/" target="_blank">AT91 Community (archive)</a></li>
  <li><a href="http://www.microchip.com/" target="_blank">Microchip</a></li>
  <li><a href="https://github.com/linux4sam" target="_blank">Linux4SAM on GitHub</a></li>
  <!--<li><a class="twikiLink" href="/bin/view/Linux4SAM/LinuxNewsletter">Atmel | Linux newsletter</a></li>-->
</ul>
<br><br>
<h2><a name="NAVIGATION"></a> NAVIGATION </h2>
<p />
<div id="navButtonl">
<a class="twikiCurrentWebHomeLink twikiLink" href="WebHome.html"> Linux4SAM</a>
</div> <ul>
<li> <a class="twikiLink" href="WebTopicList.html"> Index</a>
</li> <li> <a class="twikiLink" href="WebChanges.html"> Changes</a>
</li> <li> <a class="twikiLink" href="WebNotify.html"> Notifications</a>
</li> <li> <a class="twikiLink" href="WebStatistics.html"> Statistics</a>
</li></ul> 
<p />
</div>
<!-- /patternLeftBarContents--></div>
<!-- /patternLeftBar-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--></div><!-- /patternWrapper-->
<div id="patternTopBar">
<div id="patternTopBarContents">
<table border="0" cellpadding="0" cellspacing="0" style="width:100%; margin-top:12px;">
<tr><td valign="middle"><span id="twikiLogo" class="twikiImage"><a href="../Linux4SAM.html"><img src="../../../pub/Main/TWikiPreferences/tux2_atmel_header.png" border="0" alt="Linux4SAM" style="border:none;" /></a></span></td>
<td align="right" valign="top" class="patternMetaMenu">
 <ul>
<li> <form name="jumpForm" action="https://www.linux4sam.org/bin/view/Linux4SAM/PmFaq"><input id="jumpFormField" type="text" class="twikiInputField" name="topic" value="" size="18" /><noscript>&nbsp;<input type="submit" class="twikiButton" size="5" name="submit" value="Jump" />&nbsp;</noscript>   </form>
</li> <li> <form name="quickSearchForm" action="https://www.linux4sam.org/bin/view/Linux4SAM/WebSearch"><input type="text" class="twikiInputField" id="quickSearchBox" name="search" value="" size="18" /><input type="hidden" name="scope" value="all" /><input type="hidden" name="web" value="Linux4SAM" /><noscript>&nbsp;<input type="submit" size="5" class="twikiButton" name="submit" value="Search" />&nbsp;</noscript>   </form>
</li> <li> 
</li></ul> 
</td></tr></table>
<div class="page-title"> Linux &amp; Open Source for AT91 Microchip Microprocessors</div>
<div class="page-print">
<p>
<p />
<a href="PmFaq3fe3.html?skin=print.myskin">Print</a></p>
<p />
</div>
</div></div>
<!-- /patternTopBar-->
<div id="patternBottomBar">
<div id="patternBottomBarContents">
<div id="patternWebBottomBar">
<p>Copyright &copy; by the contributing authors. All material on this collaboration platform is the property of the contributing authors. </p>
<p>Linux&reg; is the registered trademark of Linus Torvalds in the U.S. and other countries. </p>
<p>Microchip&reg; and others, are registered trademarks or trademarks of Microchip Technology Inc. and its subsidiaries. <a href="http://twiki.org/" target="_blank" class="natExternalLink"><img width="80" height="15" border="0" title="This site is powered by the TWiki collaboration platform" alt="This site is powered by the TWiki collaboration platform" src="https://www.linux4sam.org/linux4sam/T-logo-80x15.gif" class="img-twiki"></a></p>
<p>Arm&reg; and others are registered trademarks or trademarks of Arm Limited (or its affiliates).  Other terms and product names may be trademarks of others.</p>
<p>Ideas, requests, contributions ? Connect to <a href="LinksToCommunities.html" class="twikiLink">LinksToCommunities</a> page.</p>
<p>Syndicate this site<a href="WebRss" class="linux4sam-rss">RSS</a>
<a href="WebAtom" class="linux4sam-rss">ATOM</a></p>
</div>
<!--/patternWebBottomBar--></div>
<!-- /patternBottomBarContents--></div>
<!-- /patternBottomBar-->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10893750-1");
pageTracker._initData();
pageTracker._trackPageview();
} catch(err) {}
</script>
<script type="text/javascript">
  _bizo_data_partner_id = "8288";
</script>
<script type="text/javascript">
	(function() {
		  var s = document.getElementsByTagName("script")[0];
		  var b = document.createElement("script");
		  b.type = "text/javascript";
		  b.async = true;
		  b.src = (window.location.protocol === "https:" ? "https://sjs" : "http://js") + ".bizographics.com/insight.min.js";
		  s.parentNode.insertBefore(b, s);
	 })();
</script>
<noscript>
  <img height="1" width="1" alt="" style="display:none;" src="http://www.bizographics.com/collect/?pid=8288&amp;fmt=gif" />
</noscript>
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body>
<!-- Mirrored from www.linux4sam.org/bin/view/Linux4SAM/PmFaq by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Jul 2021 19:30:27 GMT -->
</html>